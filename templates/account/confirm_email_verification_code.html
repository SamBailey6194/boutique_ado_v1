{% extends "allauth/layouts/entrance.html" %}
{% load i18n allauth account %}

{% block body_class %}email-confirm-page{% endblock %}
{% block title %}{% trans "Confirm Email" %}{% endblock %}

{% block entrance_content_inner %}
<div class="container py-5">
    <div class="row justify-content-center align-items-center align-items-lg-start">
        <div class="col-12 col-md-6 col-lg-4">
            <div class="p-4 rounded">

                {# H1 element #}
                {% include "allauth/elements/h1.html" with content="Confirm Email" tags="" %}

                {% if verification_succeeded %}
                    <div class="alert alert-success" role="alert">
                        {% blocktranslate %}
                            Your email has been successfully verified. You are now logged in.
                        {% endblocktranslate %}
                    </div>
                    <p class="mt-3 text-center">
                        <a href="{{ redirect_url|default:'/' }}">Go to Home</a>
                    </p>
                {% else %}
                    {# Instructions paragraph #}
                    <p>
                        {% blocktranslate %}
                            A confirmation email has been sent to {{ email }}.
                        {% endblocktranslate %}
                    </p>
                    <p>
                        Please check your inbox and enter the code you received.
                    </p>

                    {# Verification form #}
                    <form method="post" action="{{ form_action|default:request.path }}" class="entrance email-form">
                        {% csrf_token %}

                        {% if form %}
                            {% for field in form %}
                                {% include "allauth/elements/field.html" with field=field %}
                            {% endfor %}
                        {% endif %}

                        <div class="mt-3">
                            {% include "allauth/elements/button.html" with content="Confirm Email" type="submit" %}
                        </div>
                    </form>

                    {# Optional: link to resend code #}
                    <p class="mt-3 text-center">
                        {% blocktranslate %}
                            Didnâ€™t receive a code? <a href="{{ resend_code_url|default:request.path }}">Resend Code</a>
                        {% endblocktranslate %}
                    </p>

                    {% if form.errors %}
                        <div class="alert alert-danger mt-3" role="alert">
                            {% for field in form %}
                                {% for error in field.errors %}
                                    {{ error }}<br>
                                {% endfor %}
                            {% endfor %}
                            {% for error in form.non_field_errors %}
                                {{ error }}<br>
                            {% endfor %}
                        </div>
                    {% endif %}

                {% endif %}

            </div>
        </div>
    </div>
</div>
{% endblock %}
